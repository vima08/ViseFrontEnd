<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>Vise</title>

        <link rel="stylesheet" type="text/css" href="css/component.css" />
        <script src="js/modernizr.custom.js"></script>

        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700">  <!-- Google web font "Open Sans" -->
        <link rel="stylesheet" href="font-awesome-4.7.0/css/font-awesome.min.css">                <!-- Font Awesome -->
        <link rel="stylesheet" href="css/bootstrap.min.css">                                      <!-- Bootstrap style -->
        <link rel="stylesheet" type="text/css" href="slick/slick.css"/>
        <link rel="stylesheet" type="text/css" href="slick/slick-theme.css"/>
        <link rel="stylesheet" type="text/css" href="css/datepicker.css"/>
        <link rel="stylesheet" href="css/tooplate-style.css">                                   <!-- Templatemo style -->

        <!--<link rel="stylesheet" type="text/css" href="css/jquery.dataTables.css"> //TODO Max Выпиливай -->

        <!--<script type="text/javascript" src="js/jquery.dataTables.js"></script> //TODO Max Выпиливай -->

        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <!--<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script> //TODO Art Выпиливай -->
        <!--<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script> //TODO Art Выпиливай -->
    </head>

    <body>
        <div class="tm-main-content" id="top">
            <div class="tm-top-bar-bg"></div>
            <div class="tm-top-bar" id="tm-top-bar">
                <!-- Top Navbar -->
                <div class="container">
                    <div class="row">

                        <nav class="navbar navbar-expand-lg navbar-light">
                            <a class="navbar-brand mr-auto" href="#">
                                <img src="img/logo.png" width="120" height="80" alt="Site logo">
                                Vise
                            </a>
                            <button type="button" id="nav-toggle" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#mainNav" aria-expanded="false" aria-label="Toggle navigation">
                                <span class="navbar-toggler-icon"></span>
                            </button>
                            <div id="mainNav" class="collapse navbar-collapse tm-bg-white">
                                <ul class="navbar-nav ml-auto">
                                  <li class="nav-item">
                                    <a class="nav-link" href="#top">Home <span class="sr-only">(current)</span></a>
                                  </li>
                                  <!--<li class="nav-item"> //TODO Art Выпиливай -->
                                    <!--<a class="nav-link" href="#tm-section-4">History</a>-->
                                  <!--</li>-->
                                  <!--<li class="nav-item">-->
                                    <!--<a class="nav-link" href="#tm-section-6">Contact Us</a>-->
                                  <!--</li>-->
                                </ul>
                            </div>
                        </nav>
                    </div>
                </div>
            </div>
            <div class="tm-section tm-bg-img" id="tm-section-1">  <!--//TODO Art Индекс не должен содержать форму раз она генерируется кодом -->
                <div class="tm-bg-white ie-container-width-fix-2">
                    <div class="container ie-h-align-center-fix">
                        <div class="row">
                            <div class="col-xs-12 ml-auto mr-auto ie-container-width-fix">
                                <form action="javascript:void(null);" method="get" id="formx" class="tm-search-form tm-section-pad-2" onsubmit="call()">
                                    <div class="form-row tm-search-form-row">
                                        <div class="form-group tm-form-element tm-form-element-100">
                                            <i class="fa mt-1 tm-font-semibold tm-color-primary"> Initial capital</i>
                                            <i class="fa fa-one-marker fa-2x tm-form-element-icon-my"></i>
                                            <!--<i class="fa fa-one-marker mt-1 tm-font-semibold tm-color-primary"> Initial capital</i>-->
                                            <input name="capital" type="text" class="form-control" id="initCapital"
                                                   placeholder="Initial capital..." value="10">
                                        </div>
                                        <div class="form-group tm-form-element tm-form-element-100">
                                            <i class="fa mt-1 tm-font-semibold tm-color-primary"> Mu</i>
                                            <i class="fa fa-two-marker fa-2x tm-form-element-icon-my"></i>
                                            <input name="mu" type="text" class="form-control" id="mu"
                                                   placeholder="Mu..." value="0.1" attr_id="2">
                                        </div>
                                        <div class="form-group tm-form-element tm-form-element-100">
                                            <i class="fa mt-1 tm-font-semibold tm-color-primary"> Sigma</i>
                                            <i class="fa fa-three-marker fa-2x tm-form-element-icon-my"></i>
                                            <input name="sigma" type="text" class="form-control" id="sigmaId"
                                                   placeholder="Sigma..." value="1" attr_id="3">
                                        </div>
                                        <div class="form-group tm-form-element tm-form-element-100">
                                            <i class="fa mt-1 tm-font-semibold tm-color-primary"> K</i>
                                            <i class="fa fa-four-marker fa-2x tm-form-element-icon-my"></i>
                                            <input name="k" type="text" class="form-control" id="kId"
                                                   placeholder="K..."  value="20" attr_id="4">
                                        </div>
                                        <div class="form-group tm-form-element tm-form-element-100">
                                            <i class="fa mt-1 tm-font-semibold tm-color-primary"> Step Number</i>
                                            <i class="fa fa-five-marker fa-2x tm-form-element-icon-my"></i>
                                            <input name="stepNumber" type="text" class="form-control" id="stepNumberId"
                                                   placeholder="Step Number..."  value="10" attr_id="5">
                                        </div>
                                        <div class="form-group tm-form-element tm-form-element-100">
                                            <i class="fa mt-1 tm-font-semibold tm-color-primary"> Iteration</i>
                                            <i class="fa fa-six-marker fa-2x tm-form-element-icon-my"></i>
                                            <input name="iteration" type="text" class="form-control" id="iterationId"
                                                   placeholder="Iteration..." value="100" attr_id="6">
                                        </div>
                                        <div class="form-group tm-form-element tm-form-element-100">
                                            <i class="fa mt-1 tm-font-semibold tm-color-primary"> People Count</i>
                                            <i class="fa fa-seven-marker fa-2x tm-form-element-icon-my"></i>
                                            <input name="peopleCount" type="text" class="form-control" id="peopleCountId"
                                                   placeholder="People Count..." value="101" attr_id="7">
                                        </div>
                                        <div class="form-group tm-form-element tm-form-element-100">
                                            <i class="fa mt-1 tm-font-semibold tm-color-primary"> Majority threshold (alpha)</i>
                                            <i class="fa fa-eight-marker fa-2x tm-form-element-icon-my"></i>
                                            <input name="majorityThreshold" type="text" class="form-control" id="majorityThresholdId"
                                                   placeholder="Majority threshold..." value="0.5" attr_id="8">
                                        </div>
                                    </div>
                                    <div class="form-row tm-search-form-row">
                                        <div class="form-group tm-form-element tm-form-element-2">
                                            <i class="fa mt-1 tm-font-semibold tm-color-primary"> Variation</i>
                                            <select name="var" class="form-control" id="var" attr_id="9">
                                                <!--<option value="">Var</option>-->
                                                <option value="mu">mu</option>
                                                <option value="sigma">sigma</option>
                                            </select>
                                            <!--<i class="fa fa-var-marker fa-2x tm-form-element-icon"></i>-->
                                        </div>
                                        <div class="form-group tm-form-element tm-form-element-2">
                                            <i class="fa mt-1 tm-font-semibold tm-color-primary"> Distribution</i>
                                            <select name="distrib" class="form-control" id="distrib" attr_id="10" title="Distribution">
                                                <option value="ParetoDistribution">Pareto</option>
                                                <option value="NormalDistribution">Normal</option>
                                                <!--<option value="ParetoDistribution">ContinForm</option>-->
                                            </select>
                                            <!--<i class="fa fa-distrib-marker fa-2x tm-form-element-icon"></i>-->
                                        </div>
                                    </div>
                                        <div class="form-row tm-search-form-row">
                                            <div class="form-group tm-form-element tm-form-element-100">
                                                <i class="fa mt-1 tm-font-semibold tm-color-primary">Start</i>
                                                <i class="fa fa-start-marker fa-2x tm-form-element-icon-my"></i>
                                                <input name="start" id="start" type="text" class="form-control"
                                                       placeholder="Start" value="-250" attr_id="11">
                                            </div>
                                            <div class="form-group tm-form-element tm-form-element-100">
                                                <i class="fa mt-1 tm-font-semibold tm-color-primary">Finish</i>
                                                <i class="fa fa-finish-marker fa-2x tm-form-element-icon-my"></i>
                                                <input name="finish" id="finish" type="text" class="form-control"
                                                       placeholder="Finish" value="100" attr_id="12">
                                            </div>
                                            <div class="form-group tm-form-element tm-form-element-100">
                                                <i class="fa mt-1 tm-font-semibold tm-color-primary">Step</i>
                                                <i class="fa fa-step-marker fa-2x tm-form-element-icon-my"></i>
                                                <input name="step" id="step" type="text" class="form-control"
                                                       placeholder="Step"  value="10" attr_id="13">
                                            </div>
                                        </div>
                                        <div class="form-row tm-search-form-row">
                                            <div class="form-group tm-form-element tm-form-element-100">
                                                <i class="fa mt-1 tm-font-semibold tm-color-primary">Multiple</i>
                                                <i class="fa fa-multiple-marker fa-2x tm-form-element-icon-my"></i>
                                                <input name="multiple" id="multiple" type="text" class="form-control"
                                                       placeholder="Multiple">
                                            </div>
                                        </div>

                                    <div class="form-group tm-form-element tm-form-element-2">
                                        <button type="submit" id="submitbutton" class="btn btn-primary tm-btn-search">Start Experiment</button>
                                    </div>

                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <style>
                #myProgress {
                    width: 100%;
                    background-color: #ddd;
                }

                #myBar {
                    width: 1%;
                    height: 30px;
                    background-color: #4CAF50;
                }
            </style>

            <div id="myProgress">
                <div id="myBar"></div>
            </div>

            <div id="myDiv"></div>

            <footer class="tm-bg-dark-blue">
                <div class="container">
                    <div class="row">
                        <p class="col-sm-12 text-center tm-font-light tm-color-white p-4 tm-margin-b-0">
                        Copyright &copy; <span class="tm-current-year">2018</span> Your Company

                        - Designed by <a href="http://www.tooplate.com" class="tm-color-primary tm-font-normal" target="_parent">Tooplate</a></p>
                    </div>
                </div>
            </footer>
        </div>

        <!-- load JS files -->
        <script src="js/jquery-1.11.3.min.js"></script>             <!-- jQuery (https://jquery.com/download/) -->
        <script src="js/popper.min.js"></script>                    <!-- https://popper.js.org/ -->
        <script src="js/bootstrap.min.js"></script>                 <!-- https://getbootstrap.com/ -->
        <script src="js/datepicker.min.js"></script>                <!-- https://github.com/qodesmith/datepicker -->
        <script src="js/jquery.singlePageNav.min.js"></script>      <!-- Single Page Nav (https://github.com/ChrisWojcik/single-page-nav) -->
        <script src="slick/slick.min.js"></script>                  <!-- http://kenwheeler.github.io/slick/ -->
        <script src="js/plotly-latest.min.js"></script>
        <!--<script src="js/button.js"></script>-->
        <script src="js/jquery-3.3.1.js"></script>
        <script src="js/jquery.serializeObject.js"></script>
        <script src="js/main.js"></script>

         <!--<script>-->
             <!--var db = false;-->
            <!--$('#submitbutton').click(function() {-->
                <!--if (db) {-->

                    <!--var a = serialize();-->
                    <!--console.log(a);-->
                    <!--$.get('http://localhost:8080/ViseFrontEnd_war_exploded/resource/database/generate',-->
                        <!--function onAjaxSuccess(objId) {-->

                            <!--$.post('http://localhost:8080/ViseFrontEnd_war_exploded/resource/database/saveForm',-->
                                <!--{data: JSON.stringify(a), objId: objId});-->
                            <!--callPercentage();-->
                            <!--var msg = $('#formx').serialize();-->
                            <!--$.ajax({-->
                                <!--type: 'GET',-->
                                <!--url: 'http://localhost:8080/ViseFrontEnd_war_exploded/resource/experiment/run',-->
                                <!--data: msg,-->
                                <!--success: function (data) {-->
                                    <!--//alert(data);-->
                                    <!--drawResult(data);-->

                                    <!--$.post('http://localhost:8080/ViseFrontEnd_war_exploded/resource/database/saveResult',-->
                                        <!--{result: JSON.stringify(data), objId: objId});-->
                                <!--},-->
                                <!--error: function (xhr, str) {-->
                                    <!--alert('Возникла ошибка: ' + xhr.responseCode);-->
                                <!--},-->
                                <!--dataType: "json"-->
                            <!--});-->
                        <!--}-->
                    <!--);-->
                <!--} else {-->
                    <!--callPercentage();-->
                    <!--var msg = $('#formx').serialize();-->
                    <!--$.ajax({-->
                        <!--type: 'GET',-->
                        <!--url: 'http://localhost:8080/ViseFrontEnd_war_exploded/resource/experiment/run',-->
                        <!--data: msg,-->
                        <!--success: function (data) {-->
                            <!--drawResult(data);-->

                            <!--$.post('http://localhost:8080/ViseFrontEnd_war_exploded/resource/csv/saveCSV',-->
                                <!--{res: JSON.stringify(data)}); //пост запрос на сохранеие CSV-->
                        <!--},-->
                        <!--error: function (xhr, str) {-->
                            <!--alert('Возникла ошибка: ' + xhr.responseCode);-->
                        <!--},-->
                        <!--dataType: "json"-->
                    <!--});-->

                <!--}-->
            <!--});-->
        <!--</script>-->

        <script>
            function drawResult(data) {
                var variation = $('#var').val();
                var xData = (variation === "mu") ? data.mu : data.sigma;

                //console.log(data);
                var trace1 = {
                    x: xData,
                    y: data.capital,
                    mode: 'lines+markers',
                    name: 'Result',
                    line: {shape: 'spline'},
                    type: 'scatter'
                };
                var trace2 = {
                    x: xData,
                    y: data.peopleCount,
                    mode: 'lines+markers',
                    name: 'People Count',
                    line: {shape: 'spline'},
                    type: 'scatter'
                };
                var plotdata = [trace1, trace2];
                Plotly.newPlot('myDiv', plotdata);
                //$('#results').html(data);
            }
        </script>

        <script>
            function callPercentage() {
                var elem = document.getElementById("myBar"); //TODO Art Говорящее назание нужно, через jQuery можно
                var id = setInterval(frame, 100);
                var reset = 0;
                function frame() {
                    $.ajax({
                        type: 'GET',
                        url: 'http://localhost:8080/ViseFrontEnd_war_exploded/resource/experiment/percentage',
                        success: function(data) {
                            elem.style.width = data * 100 + '%';
                            if (data >= 1) reset++;
                            if (reset >= 5) {
                                clearInterval(id);
                                reset = 0;
                            }
                            //$('#results').html(data);
                        },
                        error:  function(xhr, str){
                            alert('Возникла ошибка: ' + xhr.responseCode);
                        },
                        dataType: "json"
                    });
                }
            }
        </script>

        <script>
            function serialize() {
                var data = {};
                $("[attr_id]").each(function () {
                    data[$(this).attr("attr_id")] = $(this).val()
                });
                return data;
            }
        </script>
    </body>
</html>

